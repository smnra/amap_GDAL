#!usr/bin/env python
#-*- coding:utf-8 _*-

"""
@author:Administrator
@file: dianping_API.py
@time: 2018/08/{DAY}
描述: 大众点评 API
返回json格式的结果
"""

import requests,re,time,os
from bs4  import BeautifulSoup
#导入webdriver
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver import ActionChains
from selenium.webdriver.support import  expected_conditions as EC

#要想调用键盘按键操作需要引入keys包
from selenium.webdriver.common.keys import Keys



class GetXDR():
    def __init__(self):

        self.headers = {"Accept": "*/*",
                        "Accept-Encoding": "gzip, deflate",
                        "Accept-Language": "zh-CN,zh;q=0.9",
                        "Cache-Control": "no-cache",
                        "Connection": "keep-alive",
                        "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                        "Cookie": "",
                        "DNT": "1",
                        "Host": "10.217.4.22:9088",
                        "Origin": "http://10.217.4.22:9088",
                        "Pragma": "no-cache",
                        "Referer": "http://10.217.4.22:9088/web/page/login/login.jsp",
                        "User-Agent": "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.162 Safari/537.36 Avast/65.0.411.162",
                        "X-Requested-With": "XMLHttpRequest"
                        }

        self.postData ={'userName': 'wangwp',
                        'userPwd': '%60%C2%BC%C3%93%C2%AE%C2%80vmoq',
                        'userVersion': '',
                        'validcheckcode': ''
                         }



        self.postDataPrep = {"queryType": "1",
                            "queryParams": '<?xml version="1.0" encoding="GB18030" standalone="yes"?><USERPARAMS><dataSource id="st_cl" moduleId="4565"/><extend><item field="TIME" value="MINUTE15"/><item field="ENDTIME" value="MINUTE15"/></extend><time id="timevalue" starttime="2018-07-28 00:00:00" endtime="2018-08-02 00:00:00" discrete="5"/><conditions><and><condition field="cellid" value="198186517" operator="=" type="string" caption="小区" display="198186517"/><condition field="DIMENSION" value="timevalue|cellid" operator="in" type="string" caption="维度" display="时间, 小区"/></and></conditions><measures><measure field="kpi_avgWebDLRate"/><measure field="kpi_avgWebOpenDelay"/></measures><dimensions><dimension field="timevalue" display="时间"/><dimension field="cellid" display=" 小区"/></dimensions></USERPARAMS>',
                            "moduleId": "1063",
                            "pushThreadKey": "key_4e1afbfa-6d0a-4f99-97ad-60519a1077f8",
                            "queryParamsLimit": '<?xml version="1.0" encoding="GB18030" standalone="yes"?><USERPARAMS><dataSource id="st_cl" moduleId="4565"/><extend><item field="TIME" value="MINUTE15"/><item field="ENDTIME" value="MINUTE15"/></extend><time id="timevalue" starttime="2018-07-28 00:00:00" endtime="2018-08-02 00:00:00" discrete="5"/><conditions><and><condition field="cellid" value="198186517" operator="=" type="string" caption="小区" display="198186517"/><condition field="DIMENSION" value="timevalue|cellid" operator="in" type="string" caption="维度" display="时间, 小区"/></and></conditions><measures><measure field="kpi_avgWebDLRate"/><measure field="kpi_avgWebOpenDelay"/></measures><dimensions><dimension field="timevalue" display="时间"/><dimension field="cellid" display=" 小区"/></dimensions></USERPARAMS>',
                            "queryLogMsg": "	开始时间:2018-07-28 00:00:00	结束时间:2018-08-02 00:00:00	小区:198186517	维度:时间, 小区	指标选择:大页面下载速率(kbps),小页面显示时长(ms)",
                            "phone": "",
                            "queryPermissions": "1",
                            "dataSourceType": "1",
                            "queryFrom": "",
                            }

        self.postAddQueryLog = {"content": "	开始时间:2018-07-28 00:00:00	结束时间:2018-08-02 00:00:00	小区:198186517	维度:时间, 小区	指标选择:大页面下载速率(kbps),小页面显示时长(ms)",
                                "moduleId": "1063",
                                "queryId": "1282C86ADD3E493AE1CC4D0D78691CED.jvm2_1063_1534994551532_5520cc49_6b38_467d_ab6e_c7fbce5486f2"
                                }

        self.postQuery_sl = {"queryid": "1282C86ADD3E493AE1CC4D0D78691CED.jvm2_1063_1534994551532_5520cc49_6b38_467d_ab6e_c7fbce5486f2",
                            "currentPage": "1",
                            "iframeid": "div_md_1063_1535001953",
                            "pageSize": "500",
                            "curPageTrans": "true"
                            }

        self.postExportAll = {"fileName": "数据业务质量分析",
                                "exportType": "2",
                                "textSplitSymbol": ",",
                                "wordSplitSymbol": ",",
                                "csvSplitSymbol": ",",
                                "csvQuotationSymbol": "",
                                "excelMinCellWidth": "80",
                                "excelMinRowHeight": "20",
                                "moreFile": "0",
                                "maxFileRow": "1000000",
                                "fieldToString": "",
                                "transout": "on",
                                "exportMethod": "exportPage",
                                "columnTitles": "时间,小区,小区ID,大页面下载速率(kbps),小页面显示时长(ms)",
                                "columnNames": "TIMEVALUE,CELLID_TRANS,CELLID,KPI_AVGWEBDLRATE,KPI_AVGWEBOPENDELAY",
                                "columnWidths": "150,85,85,142,131",
                                "moduleName": "数据业务质量分析",
                                "moduleId": "1063",
                                "queryParams": '<?xml version="1.0" encoding="GB18030" standalone="yes"?><USERPARAMS><dataSource id="st_cl" moduleId="4565"/><extend><item field="TIME" value="MINUTE15"/><item field="ENDTIME" value="MINUTE15"/></extend><time id="timevalue" starttime="2018-07-28 00:00:00" endtime="2018-08-02 00:00:00" discrete="5"/><conditions><and><condition field="cellid" value="198186517" operator="=" type="string" caption="小区" display="198186517"/><condition field="DIMENSION" value="timevalue|cellid" operator="in" type="string" caption="维度" display="时间, 小区"/></and></conditions><measures><measure field="kpi_avgWebDLRate"/><measure field="kpi_avgWebOpenDelay"/></measures><dimensions><dimension field="timevalue" display="时间"/><dimension field="cellid" display=" 小区"/></dimensions></USERPARAMS>',
                                "queryType": "1",
                                "queryFrom": "",
                                "queryid": "1282C86ADD3E493AE1CC4D0D78691CED.jvm2_1063_1534994551532_5520cc49_6b38_467d_ab6e_c7fbce5486f2",
                                "frameId": "div_md_1063_1535001953",
                                "pushThreadKey": "key_4e1afbfa-6d0a-4f99-97ad-60519a1077f8",
                                "dataSourceType": "1",
                                "exportLogMsg": "	开始时间:2018-07-28 00:00:00	结束时间:2018-08-02 00:00:00	小区:198186517	维度:时间, 小区	指标选择:大页面下载速率(kbps),小页面显示时长(ms)",
                                "page": "1"
                                }
        self.pushThreadKey = ""
        self.frameId = ''
        self.urlLogin = 'http://10.217.4.22:9088/loginController.do?method=ajaxCheckLogin'
        self.url = 'http://10.217.4.22:9088/web/page/login/login.jsp'
        self.url2 = 'http://10.217.4.22:9088/web/index.jsp'
        self.urlLongined = 'http://10.217.4.22:9088/web/index.jsp?datasourceType=1#1063'
        self.urlPrep = 'http://10.217.4.22:9088/analysisController.do?method=prep'
        self.urlAddQueryLog =  'http://10.217.4.22:9088/analysisConfigController.do?method=addQueryLog'
        self.urlQuery_sl = 'http://10.217.4.22:9088/analysisController.do?method=query_sl'
        self.urlExportAll = 'http://10.217.4.22:9088/analysisController.do?method=exportAll'
        self.enforceLogin = 'http://10.217.4.22:9088/loginController.do?method=enforceLogin&_dc=0.5855663784707259'
        self.urlLogout = 'http://10.217.4.22:9088/loginController.do?method=exitSystem'


        self.enforceLoginParma = {'method': 'enforceLogin','_dc': '0.5855663784707259'}
        self.enforceLoginHeaders= {"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
                                    "Accept-Encoding": "gzip, deflate",
                                    "Accept-Language": "zh-CN,zh;q=0.9",
                                    "Cache-Control": "no-cache",
                                    "Connection": "keep-alive",
                                    "Cookie": "theme=deepblue; JSESSIONID=5AE89FC7308F7FBC2FF981D4FB84AA64.jvm2",
                                    "DNT": "1",
                                    "Host": "10.217.4.22:9088",
                                    "Pragma": "no-cache",
                                    "Referer": "http://10.217.4.22:9088/web/page/login/login.jsp",
                                    "Upgrade-Insecure-Requests": "1",
                                    "User-Agent": "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.162 Safari/537.36 Avast/65.0.411.162"
                                    }

        self.cgiList = ["199747103","199747093","199747083","199746335","199746325","199746315","199746079","199746069","199746059","199745823","199745813","199745803","199745557","199745547","199745311","199745301","199745291","199744011","199743775","199743765","199743755","199743519","199743509","199743499","199742751","199742495","199742485","199742475","199742219","199741983","199741973","199741963","199741471","199741461","199741451","199741215","199741205","199741195","199740959","199740949","199740939","199740703","199740693","199740683","199740447","199740437","199740427","199740191","199740181","199740171","199739925","199739915","199739669","199739659","199739423","199739413","199739403","199739167","199739157","199739147","199738645","199738635","199738399","199738389","199738379","199738133","199738123","199737119","199737109","199737099","199736863","199736853","199736843","199736587","199736351","199736341","199736331","199736095","199736085","199736075","199735839","199735829","199735819","199735583","199735573","199735563","199735327","199735317","199735307","199735071","199735061","199735051","199734795","199734559","199734549","199734539","199734303","199734293","199734283","199734047","199734037","199734027","199733791","199733781","199733771","199733535","199733525","199733515","199733279","199733259","199733023","199733013","199733003","199732767","199732757","199732747","199732511","199732501","199732491","199732255","199732245","199732235","199731999","199731989","199731979","199731743","199731733","199731723","199731487","199731477","199731467","199731231","199731221","199731211","199730975","199730965","199730955","199730719","199730709","199730699","199730453","199730443","199730207","199730197","199730187","199729931","199729695","199729685","199729675","199729439","199729429","199729419","199729173","199729163","199727903","199727893","199727883","199727627","199727371","199725589","199725579","199724811","199724575","199724565","199724555","199724319","199724309","199724299","199724063","199724053","199724043","199723285","199723275","199723039","199723029","199723019","199722251","199721759","199721749","199721739","199721503","199721493","199721483","199720991","199720981","199720971","199719199","199719189","199719179","199718175","199718165","199718155","199717919","199717909","199717899","199717663","199717653","199717643","199716639","199716629","199716619","199716373","199716363","199716127","199716117","199716107","199715871","199715861","199715851","199715615","199715605","199715595","199715359","199715349","199715339","199715103","199715093","199715083","199714335","199714325","199714315","199714079","199714069","199714059","199713567","199713557","199713547","199712543","199712533","199712523","199712031","199712021","199712011","199711775","199711765","199711755","199711519","199711509","199711499","199707423","199707413","199707403","199707167","199707157","199707147","199706911","199706901","199706891","199706655","199706645","199706635","199706399","199706389","199706379","199706143","199706133","199706123","199703071","199703061","199703051","199701535","199701525","199701515","199701003","199700757","199700747","199700511","199700501","199700491","199700245","199700235","199698207","199698197","199698187","199697695","199697685","199697675","199693855","199693845","199693835","199693343","199693333","199693323","199693087","199693077","199693067","199692831","199692821","199692811","199692575","199692565","199692555","199692053","199692043","199691797","199691787","199691551","199691541","199691531","199691039","199691029","199691019","199690783","199690773","199690763","199690527","199690517","199690507","199690271","199690261","199690251","199689503","199689493","199689483","199672863","199672853","199672843","199668767","199668757","199668747","199668511","199668501","199668491","199668255","199668245","199668235","199667999","199667989","199667979","199667743","199667733","199667723","199667487","199667477","199667467","199667231","199667221","199667211","199666975","199666965","199666955","199666719","199666709","199666699","199666463","199666453","199666443","199666207","199666197","199666187","199665951","199665941","199665931","199665695","199665685","199665675","199665439","199665429","199665419","199665183","199665173","199665163","199664927","199664917","199664907","199664671","199664661","199664651","199664415","199664405","199664395","199664159","199664149","199664139","199663903","199663893","199663883","199663647","199663637","199663627","199663135","199663125","199663115","199662879","199662869","199662859","199662623","199662613","199662603","199662111","199662101","199662091","199661855","199661845","199661835","199661599","199661589","199661579","199661343","199661333","199661323","199661087","199661077","199661067","199660831","199660821","199660811","199660575","199660565","199660555","199660319","199660309","199660299","199660063","199660053","199660043","199659807","199659797","199659787","199659551","199659541","199659531","199659295","199659285","199659275","199659019","199658271","199658261","199658251","199657247","199657237","199657227","199655199","199655189","199655179","199654677","199654667","199654431","199654421","199654411","199654175","199654165","199654155","199653919","199653909","199653899","199653151","199653141","199653131","199652895","199652885","199652875","199652639","199652629","199652619","199652127","199652117","199652107","199651359","199651349","199651339","199651093","199651083","199650079","199650069","199650059","199649567","199649557","199649547","199649311","199649301","199649291","199649055","199649045","199649035","199648799","199648789","199648779","199645983","199645973","199645963","199645471","199645461","199645451","199643423","199643413","199643403","199643167","199643157","199643147","199642133","199642123","199641887","199641877","199641867","199641631","199641621","199641611","199640863","199640853","199640843","199640351","199640341","199640331","199640095","199640085","199640075","199639839","199639829","199639819","199639583","199639573","199639563","199639327","199639317","199639307","199639071","199639061","199639051","199638815","199638805","199638795","199638559","199638549","199638539","199638303","199638293","199638283","199637535","199637525","199637515","199637279","199637269","199637259","199637023","199637013","199637003","199636767","199636757","199636747","199636255","199636245","199636235","199635999","199635989","199635979","199634975","199634965","199634955","199634207","199634197","199634187","199633951","199633941","199633931","199633695","199633685","199633675","199633439","199633429","199633419","199633183","199633173","199633163","199632927","199632917","199632907","199632671","199632661","199632651","199632415","199632405","199632395","199632159","199632149","199632139","199631903","199631893","199631883","199631135","199631125","199631115","199630367","199630357","199630347","199629855","199629845","199629835","199629599","199629589","199629579","199629343","199629333","199629323","199629087","199629077","199629067","199628821","199628811","199626527","199626517","199626507","199626271","199626261","199626251","199625759","199625749","199625739","199622431","199622421","199622411","199621919","199621909","199621899","199619851","199619595","199619103","199619093","199619083","199618847","199618837","199618827","199618591","199618581","199618571","199618335","199618325","199618315","199618079","199618069","199618059","199617823","199617813","199617803","199617311","199617301","199617291","199617055","199617045","199617035","199616799","199616789","199616779","199616543","199616533","199616523","199616287","199616277","199616267","199616031","199616021","199616011","199615775","199615765","199615755","199615007","199614997","199614987","199614751","199614741","199614731","199613983","199613973","199613963","199613471","199613461","199613451","199610911","199610901","199610891","199610655","199610645","199610635","199610399","199610389","199610379","199610143","199610133","199610123","199609631","199609621","199609611","199609375","199609365","199609355","199609119","199609109","199609099","199607839","199607829","199607819","199607583","199607573","199607563","199607071","199607061","199607051","199606815","199606805","199606795","199605525","199605515","199604255","199604245","199604235","199603743","199603733","199603723","199603487","199603477","199603467","199603231","199603221","199603211","199602463","199602453","199602443","199602207","199602197","199602187","199601695","199601685","199601675","199599647","199599637","199599627","199599135","199599125","199599115","199598879","199598869","199598859","199597855","199597845","199597835","199597599","199597589","199597579","199597343","199597333","199597323","199597087","199597077","199597067","199596831","199596821","199596811","199596575","199596565","199596555","199596319","199596309","199596299","199595807","199595797","199595787","199595551","199595541","199595531","199595039","199595029","199595019","199594783","199594773","199594763","199594527","199594517","199594507","199594271","199594261","199594251","199594015","199594005","199593995","199593759","199593749","199593739","199593503","199593493","199593483","199593247","199593237","199593227","199592735","199592725","199592715","199592479","199592469","199592459","199591967","199591957","199591947","199591711","199591701","199591691","199591455","199591445","199591435","199591199","199591189","199591179","199590943","199590933","199590923","199590687","199590677","199590667","199590431","199590421","199590411","199590175","199590165","199590155","199589407","199589397","199589387","199589151","199589141","199589131","199588639","199588629","199588619","199588383","199588373","199588363","199588127","199588117","199588107","199587359","199587349","199587339","199586335","199586325","199586315","199586079","199586069","199586059","199585291","199585055","199585045","199585035","199584533","199584523","199584287","199584277","199584267","199584031","199584021","199584011","199583775","199583765","199583755","199583519","199583509","199583499","199583263","199583253","199583243","199583007","199582997","199582987","199582751","199582741","199582731","199582495","199582485","199582475","199582239","199582229","199582219","199581727","199581717","199581707","199581471","199581461","199581451","199581215","199581205","199581195","199580959","199580949","199580939","199580703","199580693","199580683","199580447","199580437","199580427","199579935","199579925","199579915","199579679","199579669","199579659","199579423","199579413","199579403","199579167","199579157","199579147","199578656","199578646","199578636","199578655","199578645","199578635","199578399","199578389","199578379","199577119","199577109","199577099","199576863","199576853","199576843","199576607","199576597","199576587","199576095","199576075","199575829","199575819","199575573","199575563","199575327","199575317","199575071","199575061","199574815","199574805","199574795","199574293","199574283","199573791","199573781","199573771","199573535","199573525","199573515","199573023","199573013","199573003","199572767","199572757","199572747","199572511","199572501","199572491","199572255","199572245","199572235","199571999","199571989","199571979","199571743","199571733","199571723","199571487","199571477","199571467","199571231","199571221","199571211","199570975","199570965","199570719","199570709","199570699","199570463","199570453","199570443","199570207","199570197","199570187","199569951","199569941","199569931","199569695","199569685","199569675","199569439","199569429","199569419","199569183","199569173","199569163","199568927","199568917","199568907","199568671","199568661","199568651","199568159","199568149","199568139","199567647","199567637","199567627","199567391","199567381","199567371","199566623","199566613","199566603","199565855","199565845","199565835","199565599","199565589","199565579","199565343","199565333","199565323","199565087","199565077","199565067","199564319","199564309","199564299","199564063","199564053","199564043","199563807","199563797","199563787","199563039","199563029","199563019","199562783","199562773","199562763","199561759","199561749","199561739","199561247","199561237","199561227","199560981","199560971","199560735","199560725","199560715","199560479","199560469","199560459","199560223","199560213","199560203","199559967","199559957","199559947","199558431","199558421","199558411","199558165","199558155","199557663","199557653","199557643","199557407","199557397","199557387","199556895","199556885","199556875","199556639","199556629","199556619","199556127","199556117","199556107","199555359","199555349","199555339","199555103","199555093","199555083","199554847","199554837","199554827","199554591","199554581","199554571","199554335","199554325","199554315","199554079","199554069","199554059","199553823","199553813","199553803","199553055","199553045","199553035","199552799","199552789","199552779","199552543","199552523","199552031","199552021","199552011","199551519","199551509","199551499","199551263","199551253","199551243","199551007","199550997","199550987","199549727","199549717","199549707","199549471","199549461","199549451","199548959","199548949","199548939","199548703","199548693","199548683","199548447","199548437","199548427","199548191","199548181","199548171","199547679","199547669","199547659","199547423","199547413","199547403","199547167","199547157","199547147","199546911","199546901","199546891","199546655","199546645","199546635","199546143","199546133","199546123","199545631","199545621","199545611","199545375","199545365","199545355","199545119","199545109","199545099","199544351","199544341","199544331","199543839","199543829","199543819","199543583","199543573","199543563","199543327","199543317","199543307","199542559","199542549","199542539","199542303","199542293","199542283","199542047","199542037","199542027","199541791","199541781","199541771","199541535","199541525","199541515","199540747","199540491","199540255","199540245","199540235","199539487","199539477","199539467","199539241","199539231","199539221","199539211","199538709","199538699","199538453","199538443","199537685","199537675","199537419","199537183","199537173","199537163","199536927","199536917","199536907","199536415","199536405","199536395","199535903","199535893","199535883","199535647","199535637","199535627","199535371","199535135","199535125","199535115","199534859","199534603","199534347","199533599","199533589","199533579","199532832","199532822","199532812","199532831","199532821","199532811","199532575","199532565","199532555","199532319","199532309","199532299","199532063","199532053","199532043","199531787","199531551","199531541","199531531","199531040","199531030","199531020","199531039","199531029","199531019","199530783","199530773","199530763","199530527","199530517","199530507","199530271","199530261","199530251","199530015","199530005","199529995","199529247","199529237","199529227","199528991","199528981","199528971","199528735","199528725","199528715","199528479","199528469","199528459","199528223","199528213","199528203","199525407","199525397","199525387","199525151","199525141","199525131","199524895","199524885","199524875","199524639","199524629","199524619","199524383","199524373","199524363","199524127","199524117","199524107","199523871","199523861","199523851","199523615","199523605","199523595","199522847","199522837","199522827","199522335","199522325","199522315","199521311","199521301","199521291","199521055","199521045","199521035","199520799","199520789","199520779","199520287","199520277","199520267","199519775","199519765","199519755","199519519","199519509","199519499","199519263","199519253","199519243","199519007","199518997","199518987","199518751","199518741","199518731","199518495","199518485","199518475","199518239","199518229","199518219","199517983","199517973","199517963","199517727","199517717","199517707","199517471","199517461","199517451","199517215","199517205","199517195","199516959","199516949","199516939","199516713","199516703","199516693","199516683","199516447","199516437","199516427","199515679","199515669","199515659","199513877","199513867","199513365","199513355","199513119","199513109","199513099","199512863","199512853","199512843","199512587","199512331","199511819","199511583","199511573","199511563","199511307","199511071","199511061","199511051","199510303","199510293","199510283","199510047","199510037","199510027","199509279","199509269","199509259","199509023","199509013","199509003","199508255","199508245","199508235","199507979","199507743","199507733","199507723","199507467","199507211","199506955","199506699","199506443","199505931","199505163","199504907","199504405","199504395","199504159","199504149","199504139","199503883","199502357","199502347","199502101","199502091","199501845","199501835","199501599","199501589","199501579","199501343","199501333","199501323","199501077","199501067","199500575","199500565","199500555","199500319","199500309","199500299","199500063","199500053","199500043","199499807","199499797","199499787","199499551","199499541","199499531","199499295","199499285","199499275","199499039","199499029","199499019","199498783","199498773","199498763","199498527","199498517","199498507","199498015","199498005","199497995","199497759","199497749","199497739","199497503","199497493","199497483","199497247","199497237","199497227","199496991","199496981","199496971","199496735","199496725","199496715","199496479","199496469","199496459","199496223","199496213","199496203","199495967","199495957","199495947","199495711","199495701","199495691","199495199","199495189","199495179","199494943","199494933","199494923","199494687","199494677","199494667","199494431","199494421","199494411","199494175","199494165","199494155","199493919","199493909","199493899","199493663","199493653","199493643","199493407","199493397","199493387","199493151","199493141","199493131","199492639","199492629","199492619","199492383","199492373","199492363","199492127","199492117","199492107","199491615","199491605","199491595","199491359","199491349","199491339","199491103","199491093","199491083","199490847","199490837","199490827","199490591","199490581","199490571","199490335","199490325","199490315","199490079","199490069","199490059","199489823","199489813","199489803","199489567","199489557","199489547","199489311","199489301","199489291","199489055","199489045","199489035","199488799","199488789","199488779","199488543","199488533","199488523","199488287","199488277","199488267","199488031","199488021","199488011","199487775","199487765","199487755","199487519","199487509","199487499","199487253","199487243","199486495","199486485","199486475","199486239","199486229","199486219","199485727","199485717","199485707","199485471","199485461","199485451","199484437","199484427","199484181","199484171","199483925","199483915","199483679","199483669","199483659","199483423","199483413","199483403","199483167","199483157","199483147","199482911","199482901","199482891","199482655","199482645","199482635","199482399","199482389","199482379","199482143","199482133","199482123","199481887","199481877","199481867","199481631","199481621","199481611","199481375","199481365","199481355","199481119","199481109","199481099","199480095","199480085","199480075","199479839","199479829","199479819","199479583","199479573","199479563","199479071","199479061","199479051","199478303","199478293","199478283","199477791","199477781","199477771","199477023","199477013","199477003","199476767","199476757","199476747","199476511","199476501","199476491","199474975","199474965","199474955","199474463","199474453","199474443","199473439","199473429","199473419","199472927","199472917","199472907","199472671","199472661","199472651","199472415","199472405","199472395","199471883","199470623","199470613","199470603","199470367","199470357","199470347","199466783","199466773","199466763","199466015","199466005","199465995","199465503","199465493","199465483","199465247","199465237","199465227","199464223","199464213","199464203","199462687","199462677","199462667","199462431","199462421","199462411","199462175","199462165","199462155","199461663","199461653","199461643","199461151","199461141","199461131","199457055","199457045","199457035","199455519","199455509","199455499","199455263","199455253","199455243","199453983","199453973","199453963","199453471","199453461","199453451","199452959","199452949","199452939","199452703","199452693","199452683","199451935","199451925","199451915","199446815","199446805","199446795","199446549","199446539","199446303","199446293","199446283","199446037","199446027","199445781","199445771","199445269","199445259","199445013","199445003","199444501","199444491","199444255","199444245","199444235","199443999","199443989","199443979","199443221","199443211","199442965","199442955","199441951","199441941","199441931","199441685","199441675","199441429","199441419","199441173","199441163","199440917","199440907","199440661","199440651","199440405","199440395","199440149","199440139","199439893","199439883","199439637","199439627","199439381","199439371","199438111","199438101","199438091","199437855","199437845","199437835","199437599","199437589","199437579","199437323","199437087","199437077","199437067","199436555","199436063","199436053","199436043","199435807","199435797","199435551","199435541","199435531","199435295","199435285","199435275","199435040","199435030","199435020","199435039","199435029","199435019","199434783","199434773","199434763","199434517","199434507","199434271","199434261","199434251","199434015","199434005","199433995","199433759","199433749","199433739","199433503","199433493","199433483","199433247","199433237","199433227","199432991","199432981","199432971","199432735","199432725","199432715","199432469","199432459","199432223","199432213","199432203","199431967","199431957","199431947","199431455","199431445","199431435","199431199","199431189","199431179","199430943","199430933","199430923","199430687","199430677","199430667","199430431","199430421","199430411","199430175","199430165","199430155","199429919","199429909","199429899","199429663","199429653","199429643","199429407","199429397","199429387","199429141","199429131","199428885","199428875","199428127","199428117","199428107","199427871","199427861","199427851","199427615","199427605","199427595","199427093","199427083","199426837","199426827","199426581","199426571","199426325","199426315","199425823","199425813","199425803","199425567","199425557","199425547","199425301","199425291","199425055","199425045","199425035","199424287","199424277","199424267","199423509","199423499","199423253","199423243","199422997","199422987","199422741","199422731","199422495","199422485","199422475","199422240","199422230","199422220","199422239","199422229","199422219","199421973","199421963","199421717","199421707","199421451","199421195","199420703","199420693","199420683","199420447","199420437","199420427","199420181","199420171","199419935","199419925","199419915","199419679","199419669","199419659","199419167","199419157","199419147","199418911","199418901","199418891","199418645","199418635","199418399","199418389","199418379","199418143","199418133","199418123","199417877","199417867","199417631","199417621","199417611","199417375","199417365","199417355","199417119","199417109","199417099","199416607","199416597","199416587","199416351","199416341","199416331","199416075","199415839","199415829","199415819","199415584","199415574","199415564","199415583","199415573","199415563","199415327","199415317","199415307","199415071","199415061","199415051","199414815","199414805","199414795","199414559","199414549","199414539","199414047","199414037","199414027","199412235","199411999","199411989","199411979","199411743","199411733","199411723","199410463","199410453","199410443","199409951","199409941","199409931","199409675","199409419","199409183","199409173","199409163","199408661","199408651","199407115","199406869","199406859","199406623","199406613","199406603","199406357","199406347","199406111","199406101","199406091","199405835","199405599","199405589","199405579","199405333","199405323","199404309","199404299","199404053","199404043","199403797","199403787","199403541","199403531","199403285","199403275","199403039","199403029","199403019","199402015","199402005","199401995","199401759","199401749","199401739","199401247","199401237","199401227","199400991","199400981","199400971","199400479","199400469","199400459","199399967","199399957","199399947","199399711","199399701","199399691","199399455","199399445","199399435","199399179","199398923","199398687","199398677","199398667","199398411","199398155","199397899","199397643","199397397","199397387","199397131","199396875","199396619","199396127","199396117","199396107","199395871","199395861","199395851","199395615","199395605","199395595","199395104","199395094","199395084","199395103","199395093","199395083","199394847","199394837","199394827","199394591","199394581","199394571","199394335","199394325","199394315","199393311","199393301","199393291","199391775","199391765","199391755","199390239","199390229","199390219","199389215","199389205","199389195","199387679","199387669","199387659","199387167","199387157","199387147","199380767","199380757","199380747","199379487","199379477","199379467","199377695","199377685","199377675","199373599","199373589","199373579","199371807","199371797","199371787","199369759","199369749","199369739","199368479","199368469","199368459","199366953","199366943","199366933","199366923","199366687","199366677","199366667","199366431","199366421","199366411","199366175","199366165","199366155","199365919","199365909","199365899","199365407","199365397","199365387","199365151","199365141","199365131","199364639","199364629","199364619","199364127","199364117","199364107","199363359","199363349","199363339","199363103","199363093","199363083","199362079","199362069","199362059","199361823","199361813","199361803","199361055","199361045","199361035","199360799","199360789","199360779","199360543","199360533","199360523","199360287","199360277","199360267","199359519","199359509","199359499","199359007","199358997","199358987","199358751","199358741","199358731","199358239","199358229","199358219","199357471","199357461","199357451","199356447","199356437","199356427","199356191","199356181","199356171","199355915","199355679","199355669","199355659","199355423","199355413","199355403","199355167","199355157","199355147","199354911","199354901","199354891","199354655","199354645","199354635","199354399","199354389","199354379","199353621","199353611","199353375","199353365","199353355","199352597","199352587","199352351","199352341","199352331","199351829","199351819","199351573","199351563","199351317","199351307","199351071","199351061","199351051","199350805","199350795","199350559","199350549","199350539","199350293","199350283","199349791","199349781","199349771","199349279","199349269","199349259","199349023","199349013","199349003","199348511","199348501","199348491","199348255","199348245","199348235","199347743","199347733","199347723","199347487","199347477","199347467","199347231","199347221","199347211","199346975","199346965","199346955","199346719","199346709","199346699","199346463","199346453","199346443","199346207","199346197","199346187","199345951","199345941","199345931","199345695","199345685","199345675","199345439","199345429","199345419","199345183","199345173","199345163","199344927","199344917","199344907","199344671","199344661","199344651","199344415","199344405","199344395","199344159","199344149","199344139","199343903","199343893","199343883","199343391","199343381","199343371","199343135","199343125","199343115","199342879","199342869","199342859","199342623","199342613","199342603","199342367","199342357","199342347","199342111","199342101","199342091","199341855","199341845","199341835","199341599","199341589","199341579","199341344","199341334","199341324","199341343","199341333","199341323","199341087","199341077","199341067","199340831","199340821","199340811","199340575","199340565","199340555","199340319","199340309","199340299","199340063","199340053","199340043","199339807","199339797","199339787","199339295","199339285","199339275","199338783","199338773","199338763","199338527","199338517","199338507","199338271","199338261","199338251","199338015","199338005","199337995","199337759","199337749","199337739","199337503","199337493","199337483","199337247","199337237","199337227","199336991","199336981","199336971","199336735","199336725","199336715","199336479","199336469","199336459","199336223","199336213","199336203","199335967","199335957","199335947","199334943","199334933","199334923","199334687","199334677","199334667","199334432","199334422","199334412","199334431","199334421","199334411","199334175","199334165","199334155","199333919","199333909","199333899","199333663","199333653","199333407","199333397","199333151","199333141","199332895","199332885","199332875","199332639","199332619","199332383","199332373","199332363","199332127","199332117","199332107","199331871","199331861","199331851","199331615","199331605","199331595","199331359","199331349","199331339","199331103","199331093","199331083","199330591","199330581","199330571","199330335","199330325","199330315","199330079","199330069","199330059","199329823","199329813","199329567","199329557","199329547","199329311","199329301","199329291","199329055","199329045","199329035","199328799","199328789","199328779","199328543","199328533","199328287","199328267","199327775","199327765","199327755","199327519","199327509","199327499","199327263","199327253","199327243","199327007","199326997","199326987","199326495","199326485","199326475","199326239","199326229","199326219","199325983","199325973","199325963","199325727","199325717","199325707","199325471","199325461","199325451","199325216","199325206","199325196","199325215","199325205","199325195","199324703","199324693","199324683","199324447","199324437","199324427","199323935","199323925","199323915","199323679","199323669","199323659","199323167","199323157","199323147","199322911","199322901","199322891","199322655","199322645","199322635","199322144","199322134","199322124","199322143","199322133","199322123","199321887","199321877","199321867","199321631","199321621","199321611","199321375","199321365","199321355","199321119","199321109","199321099","199320863","199320853","199320843","199320607","199320597","199320587","199320352","199320342","199320332","199320351","199320341","199320331","199320095","199320085","199320075","199319839","199319829","199319819","199319584","199319574","199319564","199319583","199319573","199319563","199319327","199319317","199319307","199319071","199319061","199319051","199318815","199318805","199318795","199318559","199318549","199318539","199318303","199318293","199318283","199318047","199318037","199318027","199317801","199317791","199317781","199317771","199317535","199317525","199317515","199317279","199317269","199317259","199317023","199317013","199317003","199316767","199316757","199316747","199316255","199316245","199316235","199315999","199315989","199315979","199315743","199315733","199315723","199315487","199315477","199315467","199315231","199315221","199315211","199314975","199314965","199314955","199314719","199314709","199314699","199314463","199314453","199314443","199314207","199314197","199314187","199313951","199313941","199313931","199313695","199313685","199313675","199313439","199313429","199313419","199312927","199312917","199312907","199312671","199312661","199312651","199312415","199312405","199312395","199312159","199312149","199312139","199311903","199311893","199311883","199311647","199311637","199311627","199311391","199311381","199311371","199311135","199311125","199311115","199310879","199310869","199310859","199310623","199310613","199310603","199310367","199310357","199310347","199310111","199310101","199310091","199309855","199309845","199309835","199309599","199309589","199309579","199309343","199309333","199309323","199309087","199309077","199309067","199308831","199308821","199308811","199308575","199308565","199308555","199308319","199308309","199308299","199308063","199308053","199308043","199307807","199307797","199307787","199307551","199307541","199307531","199307295","199307285","199307275","199306271","199306261","199306251","199306015","199306005","199305995","199305759","199305749","199305739","199305503","199305493","199305483","199305247","199305237","199305227","199304479","199304469","199304459","199303967","199303957","199303947","199303711","199303701","199303691","199303455","199303445","199303435","199303199","199303189","199303179","199302943","199302933","199302923","199302687","199302677","199302667","199302431","199302421","199302411","199302175","199302165","199302155","199301919","199301909","199301899","199301663","199301653","199301643","199301407","199301397","199301387","199301151","199301141","199301131","199300895","199300885","199300875","199300639","199300629","199300619","199300383","199300373","199300363","199300127","199300117","199300107","199299871","199299861","199299851","199299103","199299093","199299083","199298847","199298837","199298827","199298591","199298581","199298571","199298335","199298325","199298315","199298079","199298069","199298059","199297823","199297813","199297803","199297567","199297557","199297547","199297311","199297301","199297291","199296799","199296789","199296779","199296543","199296533","199296523","199296287","199296277","199296267","199295519","199295509","199295499","199295263","199295253","199295243","199295007","199294997","199294987","199294751","199294741","199294731","199294495","199294485","199294475","199293727","199293717","199293707","199293471","199293461","199293451","199293215","199293205","199293195","199292959","199292949","199292939","199292703","199292693","199292683","199292447","199292437","199292427","199292191","199292181","199292171","199291935","199291925","199291915","199291679","199291669","199291659","199291423","199291413","199291403","199291167","199291157","199291147","199290911","199290901","199290891","199290655","199290645","199290635","199290399","199290389","199290379","199290143","199290133","199290123","199289631","199289621","199289611","199289375","199289365","199289355","199289119","199289109","199289099","199288863","199288853","199288843","199288607","199288597","199288587","199288351","199288341","199288331","199288095","199288085","199288075","199287839","199287829","199287819","199287583","199287573","199287563","199287327","199287317","199287307","199286815","199286805","199286795","199286303","199286293","199286283","199286047","199286037","199286027","199285535","199285525","199285515","199285279","199285269","199285259","199284767","199284757","199284747","199284511","199284501","199284491","199283999","199283989","199283979","199283487","199283477","199283467","199282975","199282965","199282955","199282719","199282709","199282699","199282463","199282453","199282443","199282207","199282197","199282187","199281951","199281941","199281931","199281695","199281685","199281675","199281439","199281429","199281419","199281183","199281173","199281163","199280928","199280918","199280908","199280927","199280917","199280907","199280671","199280661","199280651","199280415","199280405","199280395","199280159","199280149","199280139","199279903","199279893","199279883","199279647","199279637","199279627","199279135","199279125","199279115","199278623","199278613","199278603","199278367","199278357","199278347","199278111","199278101","199278091","199277855","199277845","199277835","199277579","199277343","199277333","199277323","199276831","199276821","199276811","199276575","199276565","199276555","199276299","199276063","199276053","199276043","199275807","199275797","199275787","199275541","199275531","199275295","199275285","199275275","199275039","199275029","199275019","199274783","199274773","199274763","199274527","199274517","199274507","199274271","199274261","199274251","199274015","199274005","199273995","199273759","199273749","199273739","199273503","199273493","199273483","199273247","199273237","199273227","199272991","199272981","199272971","199272735","199272725","199272715","199272479","199272469","199272459","199272223","199272213","199272203","199271967","199271957","199271947","199271711","199271701","199271691","199271455","199271445","199271435","199271199","199271189","199271179","199270943","199270933","199270923","199270687","199270677","199270667","199270431","199270421","199270411","199270175","199270165","199270155","199269919","199269909","199269899","199269407","199269397","199269387","199269151","199269141","199269131","199268895","199268885","199268875","199268639","199268629","199268619","199268383","199268373","199268363","199268127","199268117","199268107","199267871","199267861","199267851","199267615","199267605","199267595","199267359","199267349","199267339","199267103","199267093","199267083","199266837","199266827","199266591","199266581","199266571","199266335","199266325","199266315","199266079","199266069","199266059","199265823","199265813","199265803","199265567","199265557","199265547","199265311","199265301","199265291","199265055","199265045","199265035","199264799","199264789","199264779","199264287","199264277","199264267","199264031","199264021","199264011","199263775","199263765","199263755","199263519","199263509","199263499","199263263","199263253","199263243","199263007","199262997","199262987","199262752","199262742","199262732","199262751","199262741","199262731","199262495","199262485","199262475","199262239","199262229","199262219","199261983","199261973","199261963","199261727","199261717","199261707","199261472","199261462","199261452","199261471","199261461","199261451","199261215","199261205","199261195","199260959","199260949","199260939","199260703","199260693","199260683","199260447","199260437","199260427","199260191","199260181","199260171","199259935","199259925","199259915","199259679","199259669","199259659","199259423","199259413","199259403","199259168","199259158","199259148","199259167","199259157","199259147","199258911","199258901","199258891","199258655","199258645","199258635","199258399","199258389","199258379","199258143","199258133","199258123","199257887","199257877","199257867","199257375","199257365","199257355","199257119","199257109","199257099","199256863","199256853","199256843","199256607","199256597","199256587","199256351","199256341","199256331","199256095","199256085","199256075","199255840","199255830","199255820","199255839","199255829","199255819","199255583","199255573","199255563","199255327","199255317","199255307","199255071","199255061","199255051","199254815","199254805","199254795","199254047","199254037","199254027","199253535","199253525","199253515","199253279","199253269","199253259","199253023","199253013","199253003","199252767","199252757","199252747","199252511","199252501","199252491","199252255","199252245","199252235","199251999","199251989","199251979","199251743","199251733","199251723","199250975","199250965","199250955","199250719","199250709","199250699","199250463","199250453","199250443","199250207","199250197","199250187","199249951","199249941","199249931","199249695","199249685","199249675","199249439","199249429","199249419","199249183","199249173","199249163","199248927","199248917","199248907","199248671","199248661","199248651","199248415","199248405","199248395","199247903","199247893","199247883","199247647","199247637","199247627","199247391","199247381","199247371","199247135","199247125","199247115","199246880","199246870","199246860","199246879","199246869","199246859","199246623","199246613","199246603","199246367","199246357","199246347","199246111","199246101","199246091","199245599","199245589","199245579","199245343","199245333","199245323","199245087","199245077","199245067","199244831","199244821","199244811","199244575","199244565","199244555","199244063","199244053","199244043","199243807","199243797","199243787","199243551","199243541","199243531","199243295","199243285","199243275","199243039","199243029","199243019","199242783","199242773","199242763","199242527","199242517","199242507","199242271","199242261","199242251","199242015","199242005","199241995","199241760","199241750","199241740","199241759","199241749","199241739","199241504","199241494","199241484","199241503","199241493","199241483","199241247","199241237","199241227","199240992","199240982","199240972","199240991","199240981","199240971","199240736","199240726","199240716","199240735","199240725","199240715","199240480","199240470","199240460","199240479","199240469","199240459","199240223","199240213","199240203","199239967","199239957","199239947","199239711","199239701","199239691","199239456","199239446","199239436","199239455","199239445","199239435","199239200","199239190","199239180","199239199","199239189","199239179","199238432","199238422","199238412","199238431","199238421","199238411","199238175","199238165","199238155","199237919","199237909","199237899","199237663","199237653","199237643","199237407","199237397","199237387","199237151","199237141","199237131","199236895","199236885","199236875","199236639","199236629","199236619","199235871","199235861","199235851","199235615","199235605","199235595","199235359","199235349","199235339","199235104","199235094","199235084","199235103","199235093","199235083","199234847","199234837","199234827","199234591","199234581","199234571","199234335","199234325","199234315","199234080","199234070","199234060","199234079","199234069","199234059","199233823","199233813","199233803","199233567","199233557","199233547","199233312","199233302","199233292","199233311","199233301","199233291","199233055","199233045","199233035","199232800","199232790","199232780","199232799","199232789","199232779","199232544","199232534","199232524","199232543","199232533","199232523","199232287","199232277","199232267","199232031","199232021","199232011","199231520","199231510","199231500","199231519","199231509","199231499","199230751","199230741","199230731","199230496","199230486","199230476","199230495","199230485","199230475","199230239","199230229","199230219","199229983","199229973","199229963","199229728","199229718","199229708","199229727","199229717","199229707","199229472","199229462","199229452","199229471","199229461","199229451","198220349","198220339","198220329","198220319","198220309","198220299","198218783","198218773","198218763","198218527","198218517","198218507","198218271","198218261","198218251","198216991","198216981","198216971","198216735","198216725","198216715","198216479","198216469","198216459","198215967","198215957","198215947","198215455","198215445","198215435","198215199","198215189","198215179","198214943","198214933","198214923","198214687","198214677","198214667","198214431","198214421","198214411","198214175","198214165","198214155","198213909","198213899","198213653","198213643","198213397","198213387","198213141","198213131","198212885","198212875","198212629","198212619","198212383","198212373","198212363","198212117","198212107","198211871","198211861","198211851","198211615","198211605","198211595","198211359","198211349","198211339","198211103","198211093","198211083","198210847","198210837","198210827","198210591","198210581","198210571","198210335","198210325","198210315","198210079","198210069","198210059","198209823","198209813","198209803","198209567","198209557","198209547","198209311","198209301","198209291","198209055","198209045","198209035","198208799","198208789","198208779","198208543","198208533","198208523","198208287","198208277","198208267","198208031","198208021","198208011","198207775","198207765","198207755","198207519","198207509","198207499","198207263","198207253","198207243","198207007","198206997","198206987","198206751","198206741","198206731","198206495","198206485","198206475","198206239","198206229","198206219","198205983","198205973","198205963","198205727","198205717","198205707","198205471","198205461","198205451","198205215","198205205","198205195","198204959","198204949","198204939","198204703","198204693","198204683","198204447","198204437","198204427","198204191","198204181","198204171","198203935","198203925","198203915","198203679","198203669","198203659","198203423","198203413","198203403","198203167","198203157","198203147","198202911","198202901","198202891","198202655","198202645","198202635","198202399","198202389","198202379","198202143","198202133","198202123","198201887","198201877","198201867","198201631","198201621","198201611","198201375","198201365","198201355","198201119","198201109","198201099","198200863","198200853","198200843","198200607","198200597","198200587","198200351","198200341","198200331","198200095","198200085","198200075","198199583","198199573","198199563","198199327","198199317","198199307","198199071","198199061","198199051","198198815","198198805","198198795","198198559","198198549","198198539","198197791","198197781","198197771","198197535","198197525","198197515","198197279","198197269","198197259","198197023","198197013","198197003","198196767","198196757","198196747","198196511","198196501","198196491","198195999","198195989","198195979","198195743","198195733","198195723","198195487","198195477","198195467","198195231","198195221","198195211","198194975","198194965","198194955","198194719","198194709","198194699","198194463","198194453","198194443","198194207","198194197","198194187","198193951","198193941","198193931","198193695","198193685","198193675","198193439","198193429","198193419","198193183","198193173","198193163","198192927","198192917","198192907","198192415","198192405","198192395","198192159","198192149","198192139","198191903","198191893","198191883","198191391","198191381","198191371","198191135","198191125","198191115","198190879","198190869","198190859","198190623","198190613","198190603","198190367","198190357","198190347","198190111","198190101","198190091","198189855","198189845","198189835","198189343","198189333","198189323","198189087","198189077","198189067","198188831","198188821","198188811","198188575","198188565","198188555","198188319","198188309","198188299","198188063","198188053","198188043","198187807","198187797","198187787","198187295","198187285","198187275","198187039","198187029","198187019","198186527","198186517","198186507","198186271","198186261","198186251","198186015","198186005","198185995","198185759","198185749","198185739","198185247","198185237","198185227","198184735","198184725","198184715","198184223","198184213","198184203","198183967","198183957","198183947","198183711","198183701","198183691","198183455","198183445","198183435","198183199","198183189","198183179","198182943","198182933","198182923","198182687","198182677","198182667","198182175","198182165","198182155","198181663","198181653","198181643","198181407","198181397","198181387","198181151","198181141","198181131"]


    def seleniumChromeInit(self):
        # 模拟创建一个浏览器对象，然后可以通过对象去操作浏览器
        driverPath = r'./Chrome/Application/chromedriver.exe'

        # 浏览器驱动
        options = webdriver.ChromeOptions()
        prefs = {'profile.default_content_settings.popups': 0, 'download.default_directory': r'C:\Users\Administrator\Downloads'}
        options.add_experimental_option('prefs', prefs)

        browserDriver = webdriver.Chrome(executable_path=driverPath, chrome_options=options)
        # browserDriver.maximize_window()     # 设置最大化
        browserDriver.set_window_size(1366,900)
        self.browserDriver = browserDriver
        return browserDriver

    def login(self,browserDriver):
        # 打开网页 url
        # self.url = 'https://www.baidu.com'
        browserDriver.get(self.url)

        # 暂停2秒，已达到完全模拟浏览器的效果
        time.sleep(2)

        # 查找百度页面的input输入框

        print(browserDriver.title)

        # id="kw"是百度搜索输入框，输入字符串"长城"
        browserDriver.find_element_by_id('userName').send_keys('wangwp')       # 帐号
        browserDriver.find_element_by_id('userPwd').send_keys('Wen@@6789')  # 密码
        browserDriver.find_element_by_id('userPwd').send_keys(Keys.RETURN)   # 登陆

        # 添加等待时间
        time.sleep(2)

        try:
            # 打印对话框文本
            print(browserDriver.switch_to.alert.text)
            # 点击对话框确定按钮
            browserDriver.switch_to.alert.accept()
        except Exception as e:
            print(e)


        try:
            # 等待到 首页载入完成  实时刷新 10 分钟  出现
            element = WebDriverWait(browserDriver, 10).until(EC.presence_of_element_located((By.ID, "is10")))
        except Exception as e:
            print(e)
        finally:
            #打印网页渲染后的源代码
            # print(browserDriver.page_source)
            # 正则表达式匹配 pushThreadKey 并保存
            self.pushThreadKey = re.findall(r"var pushThreadKey = \'(.+?)\'\;", browserDriver.page_source)[0]
            self.postDataPrep['pushThreadKey'] = self.pushThreadKey
            self.postExportAll['pushThreadKey'] = self.pushThreadKey
            print("pushThreadKey:",self.pushThreadKey)

    def refPage(self,browserDriver):
        browserDriver.refresh()
        try:
            # 等待到 首页载入完成  实时刷新 10 分钟  出现
            element = WebDriverWait(browserDriver, 10).until(EC.presence_of_element_located((By.ID, "is10")))
        except Exception as e:
            print(e)
        finally:
            #打印网页渲染后的源代码
            # print(browserDriver.page_source)
            # 正则表达式匹配 pushThreadKey 并保存
            self.pushThreadKey = re.findall(r"var pushThreadKey = \'(.+?)\'\;", browserDriver.page_source)[0]
            self.postDataPrep['pushThreadKey'] = self.pushThreadKey
            self.postExportAll['pushThreadKey'] = self.pushThreadKey
            print("pushThreadKey:",self.pushThreadKey)


    def menuClick(self,browserDriver):
        browserDriver.find_element_by_xpath("//*[contains(text(), '面向运维')]").click()                # 点击面向运维
        # browserDriver.find_element_by_xpath("//div[@class='floatNav']/ul/li/dl/dd/a[2]").text          # 打印 文本
        browserDriver.find_element_by_xpath("//div[@class='floatNav']/ul/li/dl/dd/a[2]").click()        # 点击 数据业务质量分析 连接

        try:
            ifreamTag = WebDriverWait(browserDriver, 10).until(EC.presence_of_element_located((By.XPATH, "//*[contains(@id,'div_md_1063')]")))  # 等待到 框架元素出现
        except Exception as e:
            print(e)
            time.sleep(3)
            ifreamTag = browserDriver.find_element_by_xpath("//*[contains(@id,'div_md_1063')]")  # 寻找 数据业务质量分析的 ifream 标签

        self.iframeId = ifreamTag.get_attribute("id")                                           # 保存 iframeId
        self.postQuery_sl['iframeid'] = self.iframeId
        self.postExportAll['frameid'] = self.iframeId
        print("iframeId:", self.iframeId)

        # 切换到 ifream
        browserDriver.switch_to.frame(self.iframeId)

        try:
            element = WebDriverWait(browserDriver, 10).until(EC.presence_of_element_located((By.ID, "ID_button_query")))    # 等待到 查询 按钮出现
        except Exception as e:
            print(e)
        finally:
            # print(element._parent.title)
            pass


        # 选择'  小区 纬度
        time.sleep(2)
        postsion = browserDriver.find_element_by_xpath("//span[text()='位置']/../div[1]")
        if postsion : postsion.click()
        time.sleep(2)
        cell = browserDriver.find_element_by_xpath("//span[text()='小区']")
        if cell:cell.click()



        """ 选择HTTP指标大分类"""
        http = browserDriver.find_element_by_xpath("//*[text()='HTTP']/../div[1]")
        if http:
            webdriver.ActionChains(browserDriver).move_to_element(http).perform()  # 鼠标移动到 HTTP 元素上
            http.click()                                                            # 点击 HTTP 元素
            ActionChains(browserDriver).double_click(http).perform()                # 双击


        """ 选择TCP指标大分类"""
        tcp = browserDriver.find_element_by_xpath("//*[text()='TCP']/../div[1]")
        if tcp:
            webdriver.ActionChains(browserDriver).move_to_element(tcp).perform()  # 鼠标移动到 TCP 元素上
            tcp.click()                                                            # 点击 TCP 元素
            ActionChains(browserDriver).double_click(tcp).perform()  # 双击


        """ 选择TCP指标大分类"""
        traffic = browserDriver.find_element_by_xpath("//*[text()='流量']/../div[1]")
        if traffic:
            webdriver.ActionChains(browserDriver).move_to_element(traffic).perform()  # 鼠标移动到 流量 元素上
            traffic.click()                                                            # 点击 流量 元素
            ActionChains(browserDriver).double_click(traffic).perform()  # 双击

        try:
            gridViewId = browserDriver.find_element_by_xpath("//*[@class='x-panel x-grid-locked x-column x-panel-default x-grid']").get_attribute('id')
            js = '$("#' + gridViewId + '").hide();'  # yicangdiv元素
            #js = '$("#' + gridViewId + '").remove();'  # 删除div元素
            browserDriver.execute_script(js)
        except Exception as e:
            print(r"未发现View Div")

        """
        # 选择 "大页面下载速率(kbps)"  指标
        kpi1 = browserDriver.find_element_by_xpath("//*[text()='大页面下载速率(kbps)']/..")
        if kpi1 :
            webdriver.ActionChains(browserDriver).move_to_element(kpi1).perform()       # 鼠标移动到 kpi1 元素上
            time.sleep(1)
            kpi1.click()                                                                # 点击kpi1 元素
        
        # 选择 "小页面显示时长(ms)"  指标
        kpi2 = browserDriver.find_element_by_xpath("//*[text()='小页面显示时长(ms)']/..")
        if kpi2 :
            webdriver.ActionChains(browserDriver).move_to_element(kpi2).perform()
            time.sleep(1)
            kpi2.click()

        # 选择 "页面下载时延(内容>=50KB)(ms)"  指标
        kpi3 = browserDriver.find_element_by_xpath("//*[text()='页面下载时延(内容>=50KB)(ms)']/..")
        if kpi3 :
            webdriver.ActionChains(browserDriver).move_to_element(kpi3).perform()
            time.sleep(1)
            kpi3.click()

        # 选择 "页面下载流量(内容>=50KB)(Byte)"  指标
        kpi4 = browserDriver.find_element_by_xpath("//*[text()='页面下载流量(内容>=50KB)(Byte)']/..")
        if kpi4 :
            webdriver.ActionChains(browserDriver).move_to_element(kpi4).perform()
            time.sleep(1)
            kpi4.click()

        # 选择 "页面响应平均时长(ms)"  指标
        kpi5 = browserDriver.find_element_by_xpath("//*[text()='页面响应平均时长(ms)']/..")
        if kpi5 :
            webdriver.ActionChains(browserDriver).move_to_element(kpi5).perform()
            time.sleep(1)
            kpi5.click()

        # 选择 "页面响应总时延(ms)"  指标

        kpi6 = browserDriver.find_element_by_xpath("//*[text()='页面响应总时延(ms)']/..")
        if kpi6 :
            webdriver.ActionChains(browserDriver).move_to_element(kpi6).perform()
            time.sleep(1)
            kpi6.click()

        """




        """     时间设置    """
        # 设置时间    data-value="timevalue"   name="timevalue"
        kpiTime = browserDriver.find_elements_by_xpath("//*[@data-value='timevalue']")[-1]
        webdriver.ActionChains(browserDriver).move_to_element(kpiTime).perform()
        kpiTime.click()
        time.sleep(0.5)
        timeInput = browserDriver.find_elements_by_xpath("//input[@name='timevalue']")[-1]
        timeInputId = timeInput.get_attribute("id")
        timeInput.send_keys(Keys.CONTROL, 'a')          # 全选 ctrl + a
        timeInput.send_keys(Keys.DELETE)                # 删除键
        timeInput.send_keys("2018-07-28 00:00:00 至 2018-08-02 00:00:00")     # 输入时间
        #time.sleep(2)
        # print(timeInputId)
        # browserDriver.execute_script('document.getElementById("'+ timeInputId + '").value="2018-07-28 00:00:00 至 2018-08-02 00:00:00"')
        okButton = browserDriver.find_elements_by_xpath('//*[@class="x-btn x-unselectable x-box-item x-toolbar-item x-btn-default-toolbar-small"]')[1]
        if okButton:
            okButton.click()        #点击确定按钮




    def queryCell(self,cgi ,browserDriver):
            self.currCgi = cgi
            """     小区设置    """
            # cellSelectButton = browserDriver.find_elements_by_xpath("//span[text()='小区']")[-1]
            cellSelectButton = browserDriver.find_elements_by_xpath("//*[contains(@title,'维度和条')]/../span")[-1]
               # 点击小区选择
            if cellSelectButton:
                cellSelectButton.click()

            clearEciButton = browserDriver.find_element_by_xpath("//*[text()='清空']")
            if clearEciButton:                                  # 清空上一次的ECI
                clearEciButton.click()

            cgiInput = browserDriver.find_element_by_xpath('//*[@placeholder="【CGI】"]')
            if cgiInput:
                cgiInput.send_keys(cgi)    # 输入eci


            cgiAdd = browserDriver.find_element_by_xpath('//*[contains(@class,"btnCmpAdd")]')
            if cgiAdd:
                cgiAdd.click()              # 点击添加
                time.sleep(0.5)

            cgiOKButton = browserDriver.find_element_by_xpath('//*[contains(@class,"btnCmpOk")]')
            if cgiOKButton:
                cgiOKButton.click()              # 点击 确定
                time.sleep(0.5)

            # 点击查询按钮
            queryButton= browserDriver.find_element_by_xpath("//*[@id='ID_button_query']")
            if queryButton:
                queryButton.click()              # 点击 确定
                self.queryCompalte(browserDriver)   # 等待查询完成
                self.exportAll(browserDriver)       #导出
                self.cgiList.pop(0)                 # 删除 查询过的eci



    def exportAll(self,browserDriver):
        # 导出本次查询
        exportAllButton= browserDriver.find_element_by_xpath("//*[@id='ID_button_exportAll']")
        if exportAllButton:
            exportAllButton.click()     # 点击导出按钮

            fileNameInput = browserDriver.find_element_by_xpath("//input[@name='fileName']")
            if fileNameInput:
                fileNameInput.clear()
                fileNameInput.send_keys(self.currCgi)
                # time.sleep(0.5)

            excelAllButton = browserDriver.find_element_by_xpath("//*[@value='EXCEL']")
            if excelAllButton:
                excelAllButton.click()
                time.sleep(0.5)

            csvButton = browserDriver.find_element_by_xpath("//*[text()='CSV']")
            if csvButton:
                csvButton.click()
                time.sleep(0.5)

            maxRowInput = browserDriver.find_element_by_xpath("//*[@value='50000']")
            if maxRowInput:
                maxRowInput.clear()
                maxRowInput.send_keys('100000')
                # time.sleep(1)

            startExportInput = browserDriver.find_element_by_xpath("//*[text()='开始导出']")
            if startExportInput:
                startExportInput.click()
                self.count = 0                              # 等待完成迭代计数器
                self.exportCompalte(browserDriver)          # 等待导出完成
                # self.saveCurr()                             # 保存进度



    def exportCompalte(self,browserDriver):
        # 查询是否完成 返回 True
        try:
            time.sleep(1)
            browserDriver.switch_to.default_content()  # 切换到默认的ifream
            if self.count>=300 : return False
            self.count = self.count +1
            exportCompalteButton= browserDriver.find_element_by_xpath("//div[@class='footer']/button")
            if exportCompalteButton:
                exportCompalteButton.click()
                print('导出完成')
                browserDriver.switch_to.frame(self.iframeId)  # 切换到 exportIfream
                return True
            else:
                time.sleep(1)
                print('正在导出...')
                return self.exportCompalte(browserDriver)
        except Exception as e:
            print(e)
            return self.exportCompalte(browserDriver)

    def saveCurr(self):
        with open('./tab/currentEGI.dat', 'a+', encoding='utf-8', errors=None) as f:  # 将采集进度写入文件
            f.writelines(str(self.currCgi).strip() + '\n')

    def readCurr(self):
        if os.path.isfile('./tab/currentEGI.dat'):
            with open('./tab/currentEGI.dat', 'r', encoding='utf-8', errors=None) as f:  # 读取采集进度文件
                currEgi = [line.strip() for line in f.readlines()]
                if currEgi[-1] in self.cgiList:
                    return self.cgiList.index(currEgi[-1])
                else: return 0
        else: return 0

    def queryCompalte(self,browserDriver):
        # 查询是否完成 返回 True
        stopButton= browserDriver.find_element_by_xpath("//*[@id='ID_button_stop']")
        if stopButton:
            if stopButton.get_attribute('class') == 'toolbar-item':
                time.sleep(1)
                return self.queryCompalte(browserDriver)
            if stopButton.get_attribute('class') == 'toolbar-item z-dis':
                self.saveCurr()
                return True



        browserDriver.quit()





if __name__=="__main__":
    xdr = GetXDR()
    browserDriver = xdr.seleniumChromeInit()
    xdr.login(browserDriver)
    xdr.menuClick(browserDriver)
    CurrCgiIndex = xdr.readCurr()
    for i,cgi in enumerate(xdr.cgiList[CurrCgiIndex:-1]):
        if os.path.isfile(r'C:\Users\Administrator\Downloads\\' + cgi +'.csv'): continue
        try:
            if i%45==0:
                xdr.refPage(browserDriver)
                xdr.menuClick(browserDriver)
            xdr.queryCell(cgi,browserDriver)
        except Exception as e:
            print(e)
